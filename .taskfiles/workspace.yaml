---
version: 3

vars:
  BASE: '{{ base .TASKFILE_DIR }}'

tasks:
  default:
    desc: Select the default (Services) Workspace
    cmds:
      - task: services

  services:
    desc: Select the Services Workspace
    prefix: '{{ .BASE }}:workspace'
    silent: true
    vars:
      workspace: vault.s.cym-south-1.kub3.uk
    cmds:
      - cmd: |-
          terraform workspace select -no-color "{{ .workspace }}" || \
          terraform workspace new -no-color "{{ .workspace }}"
      - cmd: echo -e '\033[0;32m{{ .workspace }} Active\033[0m'

  development:
    desc: Select the Development Workspace
    prefix: '{{ .BASE }}:workspace'
    silent: true
    vars:
      workspace: vault.d.cym-south-1.kub3.uk
    cmds:
      - cmd: |-
          terraform workspace select -no-color "{{ .workspace }}" || \
          terraform workspace new -no-color "{{ .workspace }}"
      - cmd: echo -e '\033[0;32m{{ .workspace }} Active\033[0m'

  production:
    desc: Select the Production Workspace
    prefix: '{{ .BASE }}:workspace'
    silent: true
    vars:
      workspace: vault.p.cym-south-1.kub3.uk
    cmds:
      - cmd: |-
          terraform workspace select -no-color "{{ .workspace }}" || \
          terraform workspace new -no-color "{{ .workspace }}"
      - cmd: echo -e '\033[0;32m{{ .workspace }} Active\033[0m'
